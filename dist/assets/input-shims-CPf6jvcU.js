import{B as A,K as k,L as B,M as C,G as p,F,N as H,O as y,P as G,Q as U,S as Y}from"./ionic-Bb47wDLd.js";import"./vendor-DgTrhVr3.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const D=new WeakMap,T=(e,o,t,s=0,i=!1)=>{D.has(e)!==t&&(t?q(e,o,s,i):W(e,o))},$=e=>e===e.getRootNode().activeElement,q=(e,o,t,s=!1)=>{const i=o.parentNode,r=o.cloneNode(!1);r.classList.add("cloned-input"),r.tabIndex=-1,s&&(r.disabled=!0),i.appendChild(r),D.set(e,r);const a=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",o.style.transform=`translate3d(${a}px,${t}px,0) scale(0)`},W=(e,o)=>{const t=D.get(e);t&&(D.delete(e),t.remove()),e.style.pointerEvents="",o.style.transform=""},_=50,z=(e,o,t)=>{if(!t||!o)return()=>{};const s=a=>{$(o)&&T(e,o,a)},i=()=>T(e,o,!1),r=()=>s(!0),c=()=>s(!1);return B(t,"ionScrollStart",r),B(t,"ionScrollEnd",c),o.addEventListener("blur",i),()=>{C(t,"ionScrollStart",r),C(t,"ionScrollEnd",c),o.removeEventListener("blur",i)}},I="input, textarea, [no-blur], [contenteditable]",j=()=>{let e=!0,o=!1;const t=document,s=()=>{o=!0},i=()=>{e=!0},r=c=>{if(o){o=!1;return}const a=t.activeElement;if(!a||a.matches(I))return;const f=c.target;f!==a&&(f.matches(I)||f.closest(I)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return B(t,"ionScrollStart",s),t.addEventListener("focusin",i,!0),t.addEventListener("touchend",r,!1),()=>{C(t,"ionScrollStart",s,!0),t.removeEventListener("focusin",i,!0),t.removeEventListener("touchend",r,!1)}},Q=.3,J=(e,o,t,s)=>{var i;const r=(i=e.closest("ion-item,[ion-item]"))!==null&&i!==void 0?i:e;return V(r.getBoundingClientRect(),o.getBoundingClientRect(),t,s)},V=(e,o,t,s)=>{const i=e.top,r=e.bottom,c=o.top,a=Math.min(o.bottom,s-t),f=c+15,u=a-_-r,d=f-i,S=Math.round(u<0?-u:d>0?-d:0),v=Math.min(S,i-c),n=Math.abs(v)/Q,h=Math.min(400,Math.max(150,n));return{scrollAmount:v,scrollDuration:h,scrollPadding:t,inputSafeY:-(i-f)+4}},R="$ionPaddingTimer",M=(e,o,t)=>{const s=e[R];s&&clearTimeout(s),o>0?e.style.setProperty("--keyboard-offset",`${o}px`):e[R]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),t&&t()},120)},N=(e,o,t)=>{const s=()=>{o&&M(o,0,t)};e.addEventListener("focusout",s,{once:!0})};let g=0;const K="data-ionic-skip-scroll-assist",X=(e,o,t,s,i,r,c,a=!1)=>{const f=r&&(c===void 0||c.mode===H.None);let l=!1;const u=y!==void 0?y.innerHeight:0,d=L=>{if(l===!1){l=!0;return}O(e,o,t,s,L.detail.keyboardHeight,f,a,u,!1)},S=()=>{l=!1,y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)},v=async()=>{if(o.hasAttribute(K)){o.removeAttribute(K);return}O(e,o,t,s,i,f,a,u),y===null||y===void 0||y.addEventListener("ionKeyboardDidShow",d),e.addEventListener("focusout",S)};return e.addEventListener("focusin",v),()=>{e.removeEventListener("focusin",v),y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)}},P=e=>{document.activeElement!==e&&(e.setAttribute(K,"true"),e.focus())},O=async(e,o,t,s,i,r,c=!1,a=0,f=!0)=>{if(!t&&!s)return;const l=J(e,t||s,i,a);if(t&&Math.abs(l.scrollAmount)<4){P(o),r&&t!==null&&(M(t,g),N(o,t,()=>g=0));return}if(T(e,o,!0,l.inputSafeY,c),P(o),G(()=>e.click()),r&&t&&(g=l.scrollPadding,M(t,g)),typeof window<"u"){let u;const d=async()=>{u!==void 0&&clearTimeout(u),window.removeEventListener("ionKeyboardDidShow",S),window.removeEventListener("ionKeyboardDidShow",d),t&&await Y(t,0,l.scrollAmount,l.scrollDuration),T(e,o,!1,l.inputSafeY),P(o),r&&N(o,t,()=>g=0)},S=()=>{window.removeEventListener("ionKeyboardDidShow",S),window.addEventListener("ionKeyboardDidShow",d)};if(t){const v=await U(t),L=v.scrollHeight-v.clientHeight;if(f&&l.scrollAmount>L-v.scrollTop){o.type==="password"?(l.scrollAmount+=_,window.addEventListener("ionKeyboardDidShow",S)):window.addEventListener("ionKeyboardDidShow",d),u=setTimeout(d,1e3);return}}d()}},Z=!0,oe=async(e,o)=>{if(A===void 0)return;const t=o==="ios",s=o==="android",i=e.getNumber("keyboardHeight",290),r=e.getBoolean("scrollAssist",!0),c=e.getBoolean("hideCaretOnScroll",t),a=e.getBoolean("inputBlurring",t),f=e.getBoolean("scrollPadding",!0),l=Array.from(A.querySelectorAll("ion-input, ion-textarea")),u=new WeakMap,d=new WeakMap,S=await k.getResizeMode(),v=async n=>{await new Promise(b=>p(n,b));const h=n.shadowRoot||n,w=h.querySelector("input")||h.querySelector("textarea"),m=F(n),x=m?null:n.closest("ion-footer");if(!w)return;if(m&&c&&!u.has(n)){const b=z(n,w,m);u.set(n,b)}if(!(w.type==="date"||w.type==="datetime-local")&&(m||x)&&r&&!d.has(n)){const b=X(n,w,m,x,i,f,S,s);d.set(n,b)}},L=n=>{if(c){const h=u.get(n);h&&h(),u.delete(n)}if(r){const h=d.get(n);h&&h(),d.delete(n)}};a&&Z&&j();for(const n of l)v(n);A.addEventListener("ionInputDidLoad",n=>{v(n.detail)}),A.addEventListener("ionInputDidUnload",n=>{L(n.detail)})};export{oe as startInputShims};
